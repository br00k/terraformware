#!/usr/bin/python
#
"""
  Search for free IPs on Infoblox

  Run it with -h to check the available options: iblox_list -h
"""
import argparse
import textwrap
from iblox_kit import dig


def parse():
    """ parse arguments """

    intro = """\
        This script will search for free IPs on Infoblox
        ----------------------------------------------------------------
         """
    parser = argparse.ArgumentParser(
        formatter_class=lambda prog:
        argparse.RawDescriptionHelpFormatter(prog, max_help_position=29),
        description=textwrap.dedent(intro),
        epilog="Author: Massimiliano Adamo <massimiliano.adamo@geant.org>")

    parser.add_argument('--ipv4', help='search free IP v4', action='store_true')
    parser.add_argument('--ipv6', help='search free IP v6', action='store_true')
    parser.add_argument('--all', help='search free IP v6 and v4', action='store_true')

    return parser.parse_args()


if __name__ == '__main__':
    ARGS = parse()

    if ARGS.ipv4:
        print "searching free IPs v4 on each network from 62.40.96.1 to 62.40.127.254"
        print '-'*80
        dig.ipv4()

    if ARGS.ipv6:
        print "searching free IPs v6 on each network"
        print '-'*80
        dig.ipv6()

    if ARGS.all:
        print "searching free IPs v4 on each network from 62.40.96.1 to 62.40.127.254"
        print '-'*80
        dig.ipv4()
        print "searching free IPs v6 on each network"
        print '-'*80
        dig.ipv6()

    print '-'*80
